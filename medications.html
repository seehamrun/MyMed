<link rel="stylesheet" href="style.css">
<script src="lib/jquery-3.1.1.js"></script>

<header>
  <h1>MyMed</h1>
</header>

<main>
  <header>
    <div class="feature"></div>
    <div class="feature"></div>
  </header>
  
  <div id="app">
    <header>
       <div class="system-bar">
        <div class="left">422 Mobile</div>

        <div class="centre">3:00</div>
         <div class="right"><span class="ion-battery-full"></span></div>
       </div>

      <div class="left">
      <span class="ion-chevron-left"></span>
      </div>
      <div id = "title" align="center">MyMed</div>
      <div class="right">
       <span class="ion-navicon"></span>
      </div>
    </header>

    <div class="page" id="medicinePage">
      <div class="container" id="medicationsContainer">
      </div>
    </div>

    <div class="page" id="newMedicinePage" hidden="true">
      <h2>New Medicaton</h2>
        <label>Name: </label>
        <select name="MedicineName" id="MedicineName">
          <option value="Empty"></option>
          <option value="Amoxicillin">Amoxicillin</option>
          <option value="Metformin">Metformin</option>
        </select>

        <br>
        <label>Dosage: </label>
        <input type="number" name="dosageNum" min="1" id="dosageNum"> every <input type="number" name="frequencyNum" min="1" id="frequencyNum"> <select name="frequency" id="frequency">
          <option value="Empty"></option>
          <option value="daily">day</option>
          <option value="hourly">hour</option>
          <option value="weekly">week</option>
        </select>

        <button id="medicineFormButton" onclick="medicineFormSubmitted()">Save Medicine</button>
    </div>

    <footer align="center">
      <div id="landingPageFooter">
        <input type='button' id='newMedicineButton' name='New medicine' value="+">
        <a href="home.html"><input type='button' class='' name='Home' value="Home"></a>
      </div>
      <div id="newMedicineFooter" hidden="true">
        <input type='button' id='cancelNewMedicineButton' name='Cancel' value="x"> 
      </div>
    </footer>
  </div>
 
  

  <footer>
    <div class="feature"></div>
  </footer>
</main>


<script src="medicine.js"></script>
<script>
  // Reads medicine from local storage and shows it on the page.
  function showMedicine() {
    // First make sure the medicine page isnt hidden
    $("#medicinePage").removeAttr("hidden")
    document.getElementById("newMedicinePage").setAttribute("hidden", "true")
    // Make sure the new medicine footer isnt showing either.
    $("#landingPageFooter").removeAttr("hidden") 
    document.getElementById("newMedicineFooter").setAttribute("hidden", "true")

    container = document.getElementById("medicationsContainer")
    container.innerHTML = ""
    for (medicine in getMedicine()) {
      console.log(medicine)
      container.innerHTML += "<div class='row' align='center'> <input type='button' class='medButton' name='" + medicine +"' value='" + medicine + "'> </div><br>"
    }
  }

  function medicineFormSubmitted(){
    medicine = {
      "name": document.getElementById("MedicineName").value,
      "dosageNum": document.getElementById("dosageNum").value,
      "frequencyNum": document.getElementById("frequencyNum").value,
      "frequency": document.getElementById("frequency").value,      
    }
    showConfirmation(medicine)
  }

  function showConfirmation(medicine) {
    console.log(medicine)
    addNewMedicine(medicine["name"], medicine)
    showMedicine()
  }



  $(document).on('click', '#newMedicineButton', function () {
    // hide the medicine page and show the new medicine form
    $("#newMedicinePage").removeAttr("hidden")
    document.getElementById("medicinePage").setAttribute("hidden", "true")
    // hide the new medicine button since theyre already on the new page
    // show the cancel button
    $("#newMedicineFooter").removeAttr("hidden") 
    document.getElementById("landingPageFooter").setAttribute("hidden", "true")
  });


  $(document).on('click', '#cancelNewMedicineButton', function () {
    // TODO: show cancel confirmation
    // hide the medicine page and show the new medicine form
    showMedicine()
  });



  // Finally load all the medicine from local storage and show it
  loadMedicine()
  showMedicine()
</script> 